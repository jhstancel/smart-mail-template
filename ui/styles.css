

.splash-tip.show{ opacity:1; transform: translateY(0); }
/* Parts card: remove any phantom bar under the title */
.kv:has(#partsCardBody) .parts-header {
  margin-top: 0;
  padding: 0;
  background: transparent;
  min-height: 0;  /* prevents a ‚Äòbar‚Äô look */
}

/* Tighten spacing between title and header */
.kv:has(#partsCardBody) label + #partsCardBody { margin-top: 0; }
.kv:has(#partsCardBody) .parts-header { margin-bottom: 6px; }

/* Ensure no stray backgrounds in the header cells */
.kv:has(#partsCardBody) .parts-header > * {
  background: transparent !important;
}


/* Parts inputs: same bg as card/page + rounded */
.parts-header{                    /* keep header grid tidy */
  display:grid;
  grid-template-columns: 1fr 1fr 40px;
  gap:12px;
  align-items:center;
  margin-bottom:6px;
}
.parts-row{
  display:grid;
  grid-template-columns: 1fr 1fr 40px;
  gap:12px;
  align-items:center;
  margin:8px 0;
}

/* icon buttons (minus + plus) ‚Äì unchanged size, just here for completeness */
.icon-btn{
  width:40px; height:40px; border-radius:999px;
  display:flex; align-items:center; justify-content:center;
  background:#fff; font-size:18px; line-height:1; cursor:pointer;
}
.parts-minus{ border:1px solid rgba(255,100,100,.45); }
.parts-plus{  border:1px solid rgba(80,180,120,.45); color:#2f855a; }
.parts-minus:hover{ border-color: rgba(255,80,80,.8); }
.parts-plus:hover{  border-color: rgba(60,160,100,.8); color:#276749; }

.parts-input{ height:40px; width:100%; }
.parts-qty{ text-align:center; }


/* ‚Äì (remove) = soft red ring */
.parts-minus{
  border:1px solid rgba(255,100,100,.45);
}
.parts-minus:hover{ border-color: rgba(255,80,80,.8); }

/* + (add) = soft green ring */
.parts-plus{
  border:1px solid rgba(80,180,120,.45);
  color:#2f855a;
  background:#fff;
}
.parts-plus:hover{
  border-color: rgba(60,160,100,.8);
  color:#276749;
}

/* Position of the plus row */
.parts-plus-row{ margin-top:8px; }

  /* ===== THEME VARIABLES ===== */
  :root{
    --bg:#ffffff;            /* default: light-minimal */
    --glass:#ffffffcc;
    --ink:#0b1220;
    --muted:#5b677a;
    --accent:#2457ff;
    --accent-2:#3ba3ff;
    --ok:#2ecc71; --warn:#ffb84d; --bad:#ff6b6b;
    --panel-border: rgba(12,16,24,.07);
    --card-bg1: rgba(0,0,0,.02);
    --card-bg2: rgba(0,0,0,.01);
    --card-border: rgba(12,16,24,.08);
    --btn-grad1:#255fff; --btn-grad2:#1846cf;
    --shadow-1: 0 10px 24px rgba(0,0,0,.10);
    --shadow-2: 0 16px 44px rgba(0,0,0,.12);
    --focus-ring: rgba(36,87,255,.14);
    --focus-border: rgba(36,87,255,.55);
  }
  /* Dark-Minimal */
  body[data-theme="dark-minimal"]{
    --bg:#0e1320; --glass:#151c2acc; --ink:#e9eef7; --muted:#a7b3c5;
    --accent:#7ab8ff; --accent-2:#8ee3ff; --panel-border: rgba(255,255,255,.08);
    --card-bg1: rgba(255,255,255,.06); --card-bg2: rgba(255,255,255,.02);
    --card-border: rgba(255,255,255,.10);
    --btn-grad1:#1b67ff; --btn-grad2:#124bcb;
    --shadow-1: 0 10px 30px rgba(0,0,0,.35); --shadow-2: 0 18px 44px rgba(0,0,0,.5);
    --focus-ring: rgba(122,184,255,.10); --focus-border: rgba(122,184,255,.45);
  }
  /* Cosmic (original) */
  body[data-theme="cosmic"]{
    --bg:#0b0f16; --glass:#0f1623cc; --ink:#e9eef7; --muted:#a7b3c5;
    --accent:#7ab8ff; --accent-2:#8ee3ff; --panel-border: rgba(255,255,255,.08);
    --card-bg1: rgba(255,255,255,.06); --card-bg2: rgba(255,255,255,.02);
    --card-border: rgba(255,255,255,.10);
    --btn-grad1:#1b67ff; --btn-grad2:#124bcb;
    --shadow-1: 0 10px 30px rgba(0,0,0,.35); --shadow-2: 0 18px 44px rgba(0,0,0,.5);
    --focus-ring: rgba(122,184,255,.10); --focus-border: rgba(122,184,255,.45);
  }
  /* Dusk Gradient (soft peach/purple) */
  body[data-theme="dusk-gradient"]{
    --bg: linear-gradient(180deg,#fff4ec,#f3f4ff);
    --glass:#ffffffcc; --ink:#0b1220; --muted:#586175;
    --accent:#7a5cff; --accent-2:#ff8fb3; --panel-border: rgba(12,16,24,.07);
    --card-bg1: rgba(0,0,0,.02); --card-bg2: rgba(0,0,0,.01);
    --card-border: rgba(12,16,24,.08);
    --btn-grad1:#6c55ff; --btn-grad2:#4a3ee6; --shadow-1: 0 10px 24px rgba(0,0,0,.10);
    --shadow-2: 0 16px 44px rgba(0,0,0,.12); --focus-ring: rgba(108,85,255,.16);
    --focus-border: rgba(108,85,255,.5);
  }
  /* Forest Mist (cool green/teal) */
  body[data-theme="forest-mist"]{
    --bg: linear-gradient(180deg,#eef8f4,#edf6ff);
    --glass:#ffffffcc; --ink:#0a1612; --muted:#4b5f5a;
    --accent:#1e9e7a; --accent-2:#3cb8a0; --panel-border: rgba(12,16,24,.07);
    --card-bg1: rgba(0,0,0,.02); --card-bg2: rgba(0,0,0,.01);
    --card-border: rgba(12,16,24,.08);
    --btn-grad1:#1e9e7a; --btn-grad2:#167a5e; --shadow-1: 0 10px 24px rgba(0,0,0,.10);
    --shadow-2: 0 16px 44px rgba(0,0,0,.12); --focus-ring: rgba(30,158,122,.16);
    --focus-border: rgba(30,158,122,.5);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink); background:var(--bg);
    font:15px/1.5 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
    overflow-x:hidden;
  }
  /* Parts editor polish */
.parts-editor { display:flex; flex-direction:column; gap:8px; }
.parts-table { width:100%; border-collapse:separate; border-spacing:0 6px; }
.parts-table th, .parts-table td { text-align:left; padding:6px; }
.parts-table input.input { width:100%; }
.btn-mini{ border:1px solid var(--card-border); background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2)); border-radius:10px; padding:6px 8px; cursor:pointer }
.btn-mini.danger{ border-color: rgba(255,100,100,.5); }
.parts-rows  { width:100%; border-collapse:separate; border-spacing:0 8px; }
.parts-rows td { padding:0; }
.parts-rows .cell { display:flex; align-items:center; gap:10px; }
.parts-rows input.input { width:100%; }
.parts-minus { border:1px solid rgba(255,100,100,.5); border-radius:12px; padding:4px 8px; background:transparent; cursor:pointer; }
.parts-plus  { border:1px solid var(--card-border); border-radius:14px; padding:6px 10px; background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2)); cursor:pointer; }
.parts-plus-row td { padding-top:4px; }
.parts-label { font-weight:700; }

  /* Starfield */
  canvas#stars{position:fixed; inset:0; z-index:-3;}
  .glow-veil{position:fixed; inset:-10vmax; z-index:-2;
    background: radial-gradient(60vmax 60vmax at 20% -10%, rgba(120,170,255,.12), transparent 60%),
                radial-gradient(50vmax 50vmax at 110% 20%, rgba(120,220,255,.10), transparent 55%),
                radial-gradient(40vmax 35vmax at 40% 120%, rgba(160,140,255,.08), transparent 60%);
    filter: blur(40px); pointer-events:none;
  }
  /* Hide cosmic effects for non-cosmic themes */
  body:not([data-theme="cosmic"]) canvas#stars,
  body:not([data-theme="cosmic"]) .glow-veil{ display:none; }

  .wrap{max-width:1080px; margin:48px auto; padding:0 20px}
  .panel{
    background:var(--glass);
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
    border:1px solid var(--panel-border);
    border-radius:18px;
    box-shadow: var(--shadow-1);
    padding:18px;
  }
  .title{font-weight:800; letter-spacing:.3px; margin:0 0 10px 0; font-size:20px}
  .subtitle{color:var(--muted); margin-top:2px; font-size:13px}

  /* Intent grid */
  .intent-grid{ display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); margin-top:12px; }
  .intent-card{ position:relative; padding:14px; cursor:pointer; border-radius:16px;
    background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2));
    border:1px solid var(--card-border); box-shadow: var(--shadow-1);
    transition: transform .35s cubic-bezier(.2,.7,.2,1), box-shadow .35s ease, border-color .25s ease, filter .25s ease;
    transform-origin:center; overflow:hidden; text-align:left; }
  .intent-card:hover{ transform: translateY(-2px) scale(1.03); box-shadow: var(--shadow-2); border-color: color-mix(in srgb, var(--accent) 25%, transparent); filter: saturate(1.02); }
  .intent-card.active{ transform: translateY(-1px) scale(1.01); box-shadow: var(--shadow-2); border-color: color-mix(in srgb, var(--accent) 25%, transparent); }
  .intent-card.active::after{ content:""; position:absolute; inset:0; border-radius:16px; pointer-events:none; padding:1px;
    background: linear-gradient(120deg, color-mix(in srgb, var(--accent) 0%, transparent) 0%, color-mix(in srgb, var(--accent) 65%, transparent) 12%, color-mix(in srgb, var(--accent) 0%, transparent) 30%) border-box;
    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor; mask-composite: exclude; animation: edgeGlide 3.6s linear infinite; }
  @keyframes edgeGlide { 0% { background-position: 0% 0% } 100% { background-position: 200% 0% } }

  .intent-name{font-weight:800; margin:0 0 6px; letter-spacing:.2px}
  .intent-desc{color:var(--muted); font-size:13px}

  .stage{ margin-top:16px; overflow:hidden; transition: height .45s ease, opacity .45s ease, margin .45s ease; }
  .stage.hidden{ height:0; opacity:0; margin:0; }

  label{display:block; margin:8px 0 6px; font-weight:700; letter-spacing:.2px}
  input[type=text], input[type=email], textarea, select{
    width:100%; color:var(--ink); background:color-mix(in srgb, var(--bg) 90%, black 10%);
    border:1px solid var(--panel-border); border-radius:12px; padding:12px 14px; outline:none;
    box-shadow: 0 0 0 0 rgba(0,0,0,0);
    transition: box-shadow .25s ease, border-color .25s ease, background .25s ease, transform .25s ease;
  }
:root {
  --accent: #639cff;
}

  /* Native date input tweaks */
  input[type="date"]{
    width:100%; color:var(--ink);
    background:color-mix(in srgb, var(--bg) 90%, black 10%);
    border:1px solid var(--panel-border);
    border-radius:12px; padding:12px 14px; outline:none;
    box-shadow: 0 0 0 0 rgba(0,0,0,0);
    transition: box-shadow .25s ease, border-color .25s ease, background .25s ease, transform .25s ease;
    font:inherit;
  }
  input[type="date"]:focus{
    border-color: var(--focus-border);
    box-shadow: 0 0 0 6px var(--focus-ring);
    background: color-mix(in srgb, var(--bg) 70%, white 30%);
    transform: translateZ(0) scale(1.01);
  }
  input[type="date"]::-webkit-calendar-picker-indicator{
    cursor:pointer; opacity:.9;
    filter: drop-shadow(0 0 0 rgba(0,0,0,0));
  }
  @-moz-document url-prefix(){
    input[type="date"]{ padding-right: 12px; }
  }

  input:focus, textarea:focus, select:focus{
    border-color: var(--focus-border); box-shadow: 0 0 0 6px var(--focus-ring); background: color-mix(in srgb, var(--bg) 70%, white 30%);
    transform: translateZ(0) scale(1.01);
  }
  textarea{min-height:90px; resize:vertical}

  .row{display:grid; gap:12px; grid-template-columns:1fr 1fr}
  .kvs{display:grid; gap:10px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr));}

  /* ‚ú® Pretty, consistent field boxes */
  .kv{
    display:flex; flex-direction:column; gap:6px;
    padding:12px; border-radius:14px;
    background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2));
    border:1px solid var(--card-border);
  }

  .muted{color:var(--muted); font-size:12px}
  .pill{padding:4px 10px; border-radius:999px; border:1px solid var(--panel-border); background:color-mix(in srgb, var(--bg) 85%, white 15%);}

  .btn{ background: linear-gradient(180deg, var(--btn-grad1), var(--btn-grad2)); color:white; font-weight:900; letter-spacing:.3px; border:none; border-radius:12px;
    padding:11px 14px; cursor:pointer; box-shadow: 0 10px 30px color-mix(in srgb, var(--btn-grad1) 35%, transparent), 0 0 40px color-mix(in srgb, var(--btn-grad1) 18%, transparent) inset;
    transition: transform .15s ease, box-shadow .25s ease, filter .15s ease; }
  .btn:hover{ transform: translateY(-1px) scale(1.03); filter: brightness(1.03); }
  .btn.secondary{ background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2)); color:var(--ink); border:1px solid var(--card-border); box-shadow:none }

  /* Toast success state (temporary) */
  .btn.toast{
    background: linear-gradient(180deg, var(--ok), color-mix(in srgb, var(--ok) 80%, black 20%)) !important;
    box-shadow: 0 10px 30px color-mix(in srgb, var(--ok) 35%, transparent), 0 0 40px color-mix(in srgb, var(--ok) 18%, transparent) inset !important;
  }

  .out{white-space:pre-wrap; background:color-mix(in srgb, var(--bg) 90%, black 10%); border:1px solid var(--panel-border); border-radius:12px; padding:12px;}
  .hr{height:1px; background:linear-gradient(90deg, transparent, var(--panel-border), transparent); margin:14px 0 10px 0; border:none;}
  .inline{display:flex; gap:8px; align-items:center; flex-wrap:wrap}

  @media (prefers-reduced-motion: reduce) { .glow-in { animation: none !important; } }
  .glow-in { animation: glowIn 700ms ease-out; }
  @keyframes glowIn { 0% { background: color-mix(in srgb, var(--accent) 14%, transparent) } 100% { background: transparent; } }

  #outSubject, #outBody { min-height: 42px; }
  #outBody .line{ margin: 2px 0; }
  .toggle { display:flex; align-items:center; gap:8px; cursor:pointer; }

  /* ===== Minimal theme dampening (no/low animation) ===== */
  body[data-theme$="minimal"] .intent-card,
  body[data-theme$="minimal"] .btn,
  body[data-theme$="minimal"] input,
  body[data-theme$="minimal"] textarea { transition: none; }
  body[data-theme$="minimal"] .intent-card:hover { transform:none; box-shadow: var(--shadow-1); filter:none; }

  /* ===== Settings Gear (upper-right) ===== */
  .settings{ position:fixed; top:12px; right:12px; z-index:20; }
  .settings-btn{
    display:flex; align-items:center; justify-content:center; gap:8px;
    width:38px; height:38px; border-radius:12px; border:1px solid var(--panel-border);
    background:color-mix(in srgb, var(--bg) 85%, white 15%);
    box-shadow: var(--shadow-1); cursor:pointer;
    transition: transform .15s ease, box-shadow .25s ease;
    position:relative;
  }
  .settings-btn:hover{ transform: translateY(-1px); box-shadow: var(--shadow-2); }
  
.settings-menu{
  margin-top:8px; min-width:260px; max-width:320px;
  display:none; flex-direction:column; gap:6px;          /* tighter */
  padding:10px; border-radius:14px; border:1px solid var(--panel-border);
  background:var(--glass); box-shadow: var(--shadow-2);
  max-height:210vh; overflow:auto;                        /* scrollable */
}

  .settings-menu.open{ display:flex; }
  .settings-item{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    border:1px solid var(--card-border); border-radius:12px;
    background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2));
    padding:10px 12px; cursor:pointer;
  }
  .settings-item .label{ font-weight:700; }
  .settings-item .hint{ color:var(--muted); font-size:12px; }
/* Collapsible settings drawers ‚Äì simple, no ghost gaps */
.settings-subpanel{
  display: none;              /* closed drawers render no space at all */
  margin: 0;
  padding: 0;
  border: 0;
}
.settings-subpanel.open{
  display: block;             /* render fully when open */
  margin-top: 8px;
  padding: 12px;
  border: 1px solid var(--card-border);
  border-radius: 14px;
  background: color-mix(in srgb, var(--bg) 90%, white 10%);
}

  .settings-row{ display:flex; align-items:center; gap:10px; }
  .settings-row select{ min-width:200px; }

  .chev{ width:14px; height:14px; transition: transform .25s ease; }
  .rot90{ transform: rotate(90deg); }

  /* ===== Easter Egg UI Elements ===== */

  /* Gear splash tooltip */
  .splash-tip{
    position:absolute; top:46px; right:0;
    background:var(--glass); border:1px solid var(--panel-border);
    box-shadow: var(--shadow-2); border-radius:10px; padding:8px 10px;
    white-space:nowrap; font-weight:800; font-size:12px; color:var(--ink);
    opacity:0; transform: translateY(-6px); pointer-events:none; transition: opacity .2s ease, transform .2s ease;
  }
  .splash-tip.show{ opacity:1; transform: translateY(0); }
  /* Rabbit + portal */
  .rabbit{ position:fixed; bottom:18px; left:-40px; width:18px; height:18px; border-radius:50%;
    background:white; box-shadow: 0 0 16px rgba(255,255,255,.8); z-index:30; animation: hop 1.6s ease-in-out forwards; }
  @keyframes hop{
    0%{ transform: translateX(0) translateY(0) }
    20%{ transform: translateX(20vw) translateY(-40px) }
    40%{ transform: translateX(40vw) translateY(0) }
    60%{ transform: translateX(60vw) translateY(-36px) }
    80%{ transform: translateX(80vw) translateY(0) }
    100%{ transform: translateX(105vw) translateY(-48px) }
  }
  .portal{ position:fixed; right:10%; bottom:60px; width:0; height:0; border-radius:50%; z-index:31;
    background: radial-gradient(circle at 50% 50%, rgba(120,220,255,.9), rgba(120,180,255,.25) 40%, transparent 60%);
    filter: blur(2px); animation: portalOpen .6s ease-out forwards; }
  @keyframes portalOpen { to{ width:160px; height:160px; box-shadow: 0 0 60px rgba(120,200,255,.5) inset; } }
  .portal-msg{
    position:fixed; right:calc(10% + 14px); bottom:150px; z-index:32; max-width:320px;
    background:var(--glass); border:1px solid var(--panel-border); padding:10px 12px; border-radius:12px;
    font-weight:800; box-shadow: var(--shadow-2);
    animation: fadeIn .25s ease-out both;
  }
  @keyframes fadeIn { from{ opacity:0; transform: translateY(6px) } to{ opacity:1; transform: translateY(0) } }

  /* Corruption overlay + effects */
  .corrupt-overlay{
    position:fixed; inset:0; z-index:40; pointer-events:none;
    background:
      repeating-linear-gradient(0deg, rgba(255,0,0,.03), rgba(0,255,255,.03) 2px, transparent 3px, transparent 6px),
      radial-gradient(60vmax 60vmax at 50% -10%, rgba(255,255,255,.06), transparent 60%);
    mix-blend-mode: overlay; opacity:.0; transition:opacity .25s ease;
  }
  body.corrupting .corrupt-overlay{ opacity:.9; animation: jitter .15s infinite alternate; }
  body.corrupting{ filter: hue-rotate(20deg) contrast(1.1) saturate(1.2); }
  @keyframes jitter{
    from{ transform: translate(-1px,0) skewX(.3deg) }
    to  { transform: translate(1px,0)  skewX(-.3deg)}
  }

  .flash{ position:fixed; inset:0; background:white; z-index:50; opacity:0; pointer-events:none; }
  .flash.show{ animation: flashbang .7s ease-out both; }
  @keyframes flashbang{ 0%{opacity:0} 20%{opacity:1} 100%{opacity:0} }

  .buffer{
    position:fixed; inset:0; background:color-mix(in srgb, var(--bg) 70%, black 30%); z-index:45; display:none;
    align-items:center; justify-content:center; color:var(--ink);
  }
  .buffer.show{ display:flex; }
  .buffer-card{
    background:var(--glass); border:1px solid var(--panel-border); border-radius:16px; padding:18px; width:min(520px, 90vw);
    box-shadow: var(--shadow-2); text-align:center;
  }
  .bar{ height:10px; border-radius:10px; background:color-mix(in srgb, var(--bg) 85%, white 15%); overflow:hidden; border:1px solid var(--panel-border); }
  .bar > i{ display:block; height:100%; width:0%; background: linear-gradient(90deg, var(--accent), var(--accent-2)); }
  /* Printer reload effect */
  .print-mask{ position:fixed; inset:0; background:var(--bg); z-index:44; display:none; }
  .print-mask.show{ display:block; animation: printReveal 2.4s steps(24) forwards .2s; }
  @keyframes printReveal{
    from{ clip-path: inset(0 0 100% 0); }
    to{   clip-path: inset(100% 0 0 0); }
  }
  .print-line{
    position:fixed; left:0; right:0; top:0; height:2px; z-index:46; background: color-mix(in srgb, var(--ink) 40%, transparent);
    display:none;
  }
  .print-line.show{ display:block; animation: lineSweep 2.4s linear forwards .2s; }
  @keyframes lineSweep{
    from{ transform: translateY(0) }
    to{ transform: translateY(100vh) }
  }

  /* üö´ Make the "Required Fields" helper invisible without removing it */
  #fieldsHint{ display:none !important; }
/* Scrollable Visible Intents drawer */
#subIntents.settings-subpanel{
  max-height: 56vh;    /* fits nicely on laptop screens */
  overflow-y: auto;
  padding-right: 6px;  /* room for scrollbar */
}
#subIntents .kvs .kv{
  padding: 6px 0;
  border-bottom: 1px dashed rgba(0,0,0,.06);
}
#subIntents .kvs .kv:last-child{ border-bottom: 0; }
/* Scrollable My Templates drawer */
#subUserTpls.settings-subpanel{
  max-height: 56vh;
  overflow-y: auto;
  padding-right: 6px;
}

/* --- My Templates list (card with bottom actions) --- */
.tpl-head{
  display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px;
}
.btn.small{ padding:8px 12px; border-radius:10px; font-weight:800; }
.btn.ghost{
  background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2));
  color:var(--ink);
  border:1px solid var(--card-border);
  box-shadow:none;
}

.tpl-list{ display:flex; flex-direction:column; gap:8px; }

/* Card becomes a vertical stack: content on top, actions on bottom */
.tpl-card{
  display:flex; flex-direction:column; gap:10px;
  padding:12px;
  border-radius:12px;
  background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2));
  border:1px solid var(--card-border);
  box-shadow: var(--shadow-1);
  min-height: 84px; /* breathing room */
}

/* Top area */
.tpl-main{ display:flex; align-items:center; gap:10px; min-width:0; }
.tpl-title{ font-weight:800; letter-spacing:.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.tpl-desc{ color:var(--muted); font-size:12px; margin-top:2px; }
.tpl-badge{
  font-size:11px; padding:3px 8px; border-radius:999px;
  border:1px solid var(--panel-border);
  color:var(--muted);
  background:color-mix(in srgb, var(--bg) 85%, white 15%);
}

/* Bottom actions: full width row, never overlaps text */
.tpl-actions{
  display:flex; align-items:center; justify-content:flex-end; gap:8px;
  padding-top:10px; margin-top:2px;
  border-top:1px solid var(--card-border);
}
.tpl-actions .btn{
  padding:6px 10px; border-radius:9px; font-weight:800;
  border:1px solid var(--card-border);
  background:transparent;
}
.tpl-actions .btn.ghost{
  background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2));
}
.tpl-actions .btn.danger{
  background: linear-gradient(180deg, var(--bad), color-mix(in srgb, var(--bad) 80%, black 20%));
  color:#fff; border-color: color-mix(in srgb, var(--bad) 55%, black 45%);
}

/* Small screens: keep same layout, just left-align actions */
@media (max-width:520px){
  .tpl-actions{ justify-content:flex-start; }
}




  .evil-larry{
    position:fixed; left:0; top:0;
    width:420px; height:420px;
    z-index:9999;
    pointer-events:none; will-change:transform,opacity;
    transform:translate(-50%,-420px) rotate(0deg);
    filter: drop-shadow(0 20px 50px rgba(0,0,0,.55));
  }
  .evil-larry img{
    display:block; width:100%; height:100%;
    object-fit:contain; user-select:none; font-size:0;
  }
  @media (max-width:520px){
    .evil-larry{ width:260px; height:260px; transform:translate(-50%,-260px) rotate(0deg); }
  }

/* make Parts inputs follow theme text color */
.parts-input {
  color: inherit;                /* match surrounding theme text */
  background: transparent;
  border: 1px solid var(--card-border, rgba(255,255,255,.1));
  border-radius: 12px;
  height: 44px;
  width: 100%;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
.parts-input:focus {
  border-color: var(--accent, #639cff);
  box-shadow: 0 0 0 2px rgba(99,156,255,.25);
  outline: none;
}
.parts-input::placeholder {
  color: transparent;            /* ensures hidden placeholder stays hidden */
}

/* ensure icons stay visible in both modes */
.icon-btn.parts-plus,
.icon-btn.parts-minus {
  background: var(--card-bg2, #fff);
  color: inherit;
}
/* Settings ‚Äúcard headers‚Äù feel and subpanels spacing */
.settings-item{
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  border:1px solid var(--card-border); border-radius:14px;
  background:linear-gradient(180deg, var(--card-bg1), var(--card-bg2));
  padding:12px 14px; cursor:pointer;
  box-shadow: var(--shadow-1);
}
.settings-subpanel.open{
  max-height: none;          /* let it grow naturally */
  overflow: visible;         /* don‚Äôt clip inner content */
  opacity: 1;
  margin-top: 6px;
  padding: 12px;
  border: 1px solid var(--card-border);
  border-radius: 14px;
  background: color-mix(in srgb, var(--bg) 90%, white 10%);
}

/* Segmented control (Preview / Type / Off) */
.seg{
  display:inline-flex; gap:6px; align-items:center;
  padding:6px; border-radius:14px;
  background:color-mix(in srgb, var(--bg) 85%, white 15%);
  border:1px solid var(--panel-border);
}
.seg .opt{
  appearance:none; border:1px solid transparent; background:transparent;
  padding:8px 14px; border-radius:12px; font-weight:800; cursor:pointer;
  transition:transform .08s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
}
.seg .opt:hover{ transform:translateY(-1px); }
.seg .opt[aria-selected="true"]{
  background:#fff; color:var(--ink); border-color:var(--panel-border); box-shadow: var(--shadow-1);
}
body[data-theme="dark-minimal"] .seg .opt[aria-selected="true"],
body[data-theme="cosmic"] .seg .opt[aria-selected="true"]{
  background:color-mix(in srgb, var(--glass) 80%, black 20%);
}

/* Make selects/inputs feel consistent inside subpanels */
.settings-subpanel select,
.settings-subpanel input[type="text"]{
  background:color-mix(in srgb, var(--bg) 92%, black 8%);
  border-radius:12px; border:1px solid var(--panel-border); padding:10px 12px;
}




  /* Nyan Cat + trail */
  .nyan-cat{
  position:fixed;
  left:-100px;
  top:0;
  width:96px;
  height:auto;
  z-index:9998;
  pointer-events:none;
  will-change:transform,opacity;
  image-rendering: crisp-edges;
  filter: drop-shadow(0 6px 12px rgba(0,0,0,.25));
}

  .nyan-ribbon{
    position:fixed; left:0; top:0; z-index:9997;
    pointer-events:none; will-change:transform,opacity;
    border-radius:3px; opacity:.95; mix-blend-mode:screen;
    animation: nyanFade 1.8s ease-out forwards;
    box-shadow: 0 0 10px rgba(255,255,255,.25);
    filter: blur(.3px);
  }
  @keyframes nyanFade{
    to{ opacity:0; transform: translateX(-16px) scaleX(1.2) scaleY(.9); filter: blur(3px); }
  }


/* ==== Pastell theme (kawaii, soft pastels + lots of white) ==== */
body[data-theme="pastell"],
html[data-theme="pastell"] {
  --bg:#ffffff;
  --glass:#ffffffcc;
  --ink:#0f1320;
  --muted:#6a7385;
  --accent:#ff9ac8;       /* pink accent */
  --accent-2:#8ecbff;     /* soft blue accent */
  --ok:#37d391; --warn:#ffbe6a; --bad:#ff7b7b;

  --panel-border: rgba(12,16,24,.06);
  --card-bg1: rgba(255,170,205,.08);  /* faint pink wash */
  --card-bg2: rgba(180,220,255,.06);  /* faint blue wash */
  --card-border: rgba(12,16,24,.06);

  --btn-grad1:#ff9ac8; --btn-grad2:#ffd9e8;
  --shadow-1: 0 10px 20px rgba(255,154,200,.20);
  --shadow-2: 0 16px 36px rgba(142,203,255,.25);

  --focus-ring: rgba(255,154,200,.20);
  --focus-border: rgba(255,154,200,.65);

  /* subtle background gradient‚Äîvery light */
  background:
    radial-gradient(1200px 800px at 20% -10%, #ffd9e8 24%, transparent 60%),
    radial-gradient(1200px 800px at 110% 10%, #d9ecff 28%, transparent 60%),
    var(--bg);
}

/* Pastell: faint borders + soft cards */
body[data-theme="pastell"] .panel,
html[data-theme="pastell"] .panel {
  backdrop-filter: blur(8px);
}

/* ==== Falling pets layer ==== */
#petFlakes{
  position: fixed;
  inset: 0;
  z-index: 0;          /* behind normal UI, above plain background */
  overflow: hidden;
  display:none;        /* only enabled when theme is Pastell */
}

/* individual flakes */
.pet-flake{
  position: absolute;
  top: -40px;
  will-change: transform, top, left, opacity;
  animation: petFall var(--fall-dur, 60s) linear forwards, petDrift 6s ease-in-out infinite alternate;
  user-select: none;
  -webkit-user-drag: none;
  image-rendering: auto;
  opacity: 0.95;
  cursor: pointer;
}

/* click-to-pop */
.pet-flake.pop{
  animation: petPop .22s ease-out forwards;
}

@keyframes petFall {
  from { transform: translateY(0) rotate(var(--rot, 0deg)); }
  to   { transform: translateY(calc(100vh + 60px)) rotate(var(--rot, 0deg)); }
}

/* gentle left-right drift (no spin) */
@keyframes petDrift {
  from { transform: translateX(0) rotate(var(--rot, 0deg)); }
  to   { transform: translateX(var(--drift, 10px)) rotate(var(--rot, 0deg)); }
}

/* pop animation */
@keyframes petPop {
  0%   { transform: scale(1); opacity: 0.95; }
  60%  { transform: scale(1.25); opacity: 1; }
  100% { transform: scale(0.7); opacity: 0; }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  #petFlakes, .pet-flake{
    animation: none !important;
  }
}


/* ==== Pastell theme (kawaii, soft pastels + lots of white) ==== */
html[data-theme="pastell"],
body[data-theme="pastell"] {
  --bg:#ffffff;
  --glass:#ffffffcc;
  --ink:#0f1320;
  --muted:#6a7385;
  --accent:#ff9ac8;       /* pink accent */
  --accent-2:#8ecbff;     /* soft blue accent */
  --ok:#37d391; --warn:#ffbe6a; --bad:#ff7b7b;

  --panel-border: rgba(12,16,24,.06);
  --card-bg1: rgba(255,170,205,.08);  /* faint pink wash */
  --card-bg2: rgba(180,220,255,.06);  /* faint blue wash */
  --card-border: rgba(12,16,24,.06);

  --btn-grad1:#ff9ac8; --btn-grad2:#ffd9e8;
  --shadow-1: 0 10px 20px rgba(255,154,200,.20);
  --shadow-2: 0 16px 36px rgba(142,203,255,.25);

  --focus-ring: rgba(255,154,200,.20);
  --focus-border: rgba(255,154,200,.65);
}

/* gentle pastel background on body when Pastell is active */
body[data-theme="pastell"] {
  background:
    radial-gradient(1200px 800px at 20% -10%, #ffd9e8 12%, transparent 60%),
    radial-gradient(1200px 800px at 110% 10%, #d9ecff 14%, transparent 62%),
    var(--bg);
}

/* ==== Falling pets layer ==== */
#petFlakes{
  position: fixed;
  inset: 0;
  z-index: 1;          /* above plain bg, below cards */
  overflow: hidden;
  display:none;        /* shown only when Pastell is active */
  pointer-events: none; /* background; UI fully clickable */
}

.pet-flake{
  position: absolute;
  top: -40px;
  will-change: top, transform, left, opacity;
  animation: petFallTop var(--fall-dur, 60s) linear forwards,
             petDriftX 6s ease-in-out infinite alternate;
  user-select: none;
  -webkit-user-drag: none;
  image-rendering: auto;
  opacity: 0.95;
  pointer-events: auto;
  cursor: pointer;
}

@keyframes petFallTop {
  to { top: calc(100vh + 60px); }  /* start value = inline style */
}
@keyframes petDriftX {
  from { transform: translateX(0) rotate(var(--rot, 0deg)); }
  to   { transform: translateX(var(--drift, 10px)) rotate(var(--rot, 0deg)); }
}

/* click-to-pop */
.pet-flake.pop{
  animation: petPop .22s ease-out forwards;
}
/* pop animation */
@keyframes petPop {
  0%   { transform: scale(1); opacity: 0.95; }
  60%  { transform: scale(1.25); opacity: 1; }
  100% { transform: scale(0.7); opacity: 0; }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  #petFlakes, .pet-flake{
    animation: none !important;
  }
}
/* =======================================================
   Pastell Theme ‚Äî kawaii pink/blue + floating pets
   ======================================================= */
html[data-theme="pastell"],
body[data-theme="pastell"] {
  --bg: #fff;
  --ink: #1a1a1a;
  --accent: #ffb7e2;
  --accent-2: #aee4ff;
  background:
    radial-gradient(1600px 900px at 10% -10%,  #ffd9e8 20%, transparent 60%),
    radial-gradient(1600px 900px at 100% 20%, #d9ecff 25%, transparent 70%),
    #ffffff;
  color: var(--ink);
}

body[data-theme="pastell"] .panel {
  background: rgba(255,255,255,0.9);
  border: 1px solid rgba(255,200,240,0.3);
  box-shadow: 0 8px 24px rgba(255,170,210,0.25);
}

/* Floating pet flakes */
#petFlakes {
  position: fixed;
  inset: 0;
  z-index: 0; /* behind panels but above background */
  overflow: hidden;
  pointer-events: none;
}

.pet-flake {
  position: absolute;
  top: -40px;
  opacity: 0.95;
  user-select: none;
  pointer-events: auto;
  cursor: pointer;
  will-change: top, transform;
  animation: petFall var(--fall-dur, 60s) linear forwards,
             petDrift 6s ease-in-out infinite alternate;
}

.pet-flake.pop {
  animation: petPop .25s ease-out forwards;
}

@keyframes petFall {
  to { top: calc(100vh + 50px); }
}
@keyframes petDrift {
  from { transform: translateX(0) rotate(var(--rot,0deg)); }
  to { transform: translateX(var(--drift,12px)) rotate(var(--rot,0deg)); }
}
@keyframes petPop {
  0%   { transform: scale(1); opacity: .95; }
  60%  { transform: scale(1.25); opacity: 1; }
  100% { transform: scale(.6); opacity: 0; }
}


/* =======================================================
   Pastell ‚Äî visible drifting pets
   ======================================================= */
#petFlakes{
  position:fixed;
  inset:0;
  z-index:0;
  overflow:hidden;
  display:none;
  pointer-events:none;
}

.pet-flake{
  position:absolute;
  top:-40px;
  opacity:.95;
  user-select:none;
  will-change:top,transform;
  animation:petFallTop var(--fall-dur,60s) linear forwards,
             petDriftX 6s ease-in-out infinite alternate;
}

.pet-flake.pop{ animation:petPop .22s ease-out forwards; }

@keyframes petFallTop{ to{ top:calc(100vh + 60px); } }
@keyframes petDriftX{
  from{ transform:translateX(0) rotate(var(--rot,0deg)); }
  to{ transform:translateX(var(--drift,12px)) rotate(var(--rot,0deg)); }
}
@keyframes petPop{
  0%{ transform:scale(1); opacity:.95; }
  60%{ transform:scale(1.25); opacity:1; }
  100%{ transform:scale(.7); opacity:0; }
}

